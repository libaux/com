import{d as t,m as e,a,j as i,k as s,o,c as n,w as r,e as l,b as u,f as d,p as h,q as c,i as p,n as g,K as m,O as f,Y as y,g as w,L as x,l as _,F as b,Z as v,ac as k}from"./index-a54b26d9.js";import{_ as $}from"./u-icon.f4540124.js";import{_ as S}from"./u-transition.bddc12a9.js";import{_ as j}from"./plugin-vueexport-helper.1b428a4d.js";import{_ as I}from"./uni-list-item.383885e4.js";import{_ as C}from"./uni-icons.bc4ac9ed.js";import{_ as P}from"./uni-easyinput.c52ee4b1.js";import{_ as L}from"./u-row.0a7753f8.js";import{_ as U}from"./u-avatar.7359b5a9.js";import{_ as E,a as B}from"./uni-popup.59087106.js";const z={props:{src:{type:String,default:t.image.src},mode:{type:String,default:t.image.mode},width:{type:[String,Number],default:t.image.width},height:{type:[String,Number],default:t.image.height},shape:{type:String,default:t.image.shape},radius:{type:[String,Number],default:t.image.radius},lazyLoad:{type:Boolean,default:t.image.lazyLoad},showMenuByLongpress:{type:Boolean,default:t.image.showMenuByLongpress},loadingIcon:{type:String,default:t.image.loadingIcon},errorIcon:{type:String,default:t.image.errorIcon},showLoading:{type:Boolean,default:t.image.showLoading},showError:{type:Boolean,default:t.image.showError},fade:{type:Boolean,default:t.image.fade},webp:{type:Boolean,default:t.image.webp},duration:{type:[String,Number],default:t.image.duration},bgColor:{type:String,default:t.image.bgColor}}};const D=j({name:"u-image",mixins:[e,a,z],data(){return{isError:!1,loading:!0,opacity:1,durationTime:this.duration,backgroundStyle:{},show:!1}},watch:{src:{immediate:!0,handler(t){t?(this.isError=!1,this.loading=!0):this.isError=!0}}},computed:{wrapStyle(){let t={};return t.width=this.$u.addUnit(this.width),t.height=this.$u.addUnit(this.height),t.borderRadius="circle"==this.shape?"10000px":uni.$u.addUnit(this.radius),t.overflow=this.radius>0?"hidden":"visible",uni.$u.deepMerge(t,uni.$u.addStyle(this.customStyle))}},mounted(){this.show=!0},emits:["click","error","load"],methods:{onClick(){this.$emit("click")},onErrorHandler(t){this.loading=!1,this.isError=!0,this.$emit("error",t)},onLoadHandler(t){this.loading=!1,this.isError=!1,this.$emit("load",t),this.removeBgColor()},removeBgColor(){this.backgroundStyle={backgroundColor:"transparent"}}}},[["render",function(t,e,a,g,m,f){const y=c,w=i(s("u-icon"),$),x=p,_=i(s("u-transition"),S);return o(),n(_,{mode:"fade",show:m.show,duration:t.fade?1e3:0},{default:r((()=>[l(x,{class:"u-image",onClick:f.onClick,style:u([f.wrapStyle,m.backgroundStyle])},{default:r((()=>[m.isError?d("",!0):(o(),n(y,{key:0,src:t.src,mode:t.mode,onError:f.onErrorHandler,onLoad:f.onLoadHandler,"show-menu-by-longpress":t.showMenuByLongpress,"lazy-load":t.lazyLoad,class:"u-image__image",style:u({borderRadius:"circle"==t.shape?"10000px":t.$u.addUnit(t.radius),width:t.$u.addUnit(t.width),height:t.$u.addUnit(t.height)})},null,8,["src","mode","onError","onLoad","show-menu-by-longpress","lazy-load","style"])),t.showLoading&&m.loading?(o(),n(x,{key:1,class:"u-image__loading",style:u({borderRadius:"circle"==t.shape?"50%":t.$u.addUnit(t.radius),backgroundColor:this.bgColor,width:t.$u.addUnit(t.width),height:t.$u.addUnit(t.height)})},{default:r((()=>[h(t.$slots,"loading",{},(()=>[l(w,{name:t.loadingIcon,width:t.width,height:t.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):d("",!0),t.showError&&m.isError&&!m.loading?(o(),n(x,{key:2,class:"u-image__error",style:u({borderRadius:"circle"==t.shape?"50%":t.$u.addUnit(t.radius),width:t.$u.addUnit(t.width),height:t.$u.addUnit(t.height)})},{default:r((()=>[h(t.$slots,"error",{},(()=>[l(w,{name:t.errorIcon,width:t.width,height:t.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):d("",!0)])),_:3},8,["onClick","style"])])),_:3},8,["show","duration"])}],["__scopeId","data-v-f54b76b2"]]);const W=j({name:"u-col",mixins:[e,a,{props:{span:{type:[String,Number],default:t.col.span},offset:{type:[String,Number],default:t.col.offset},justify:{type:String,default:t.col.justify},align:{type:String,default:t.col.align},textAlign:{type:String,default:t.col.textAlign}}}],data:()=>({width:0,parentData:{gutter:0},gridNum:12}),options:{virtualHost:!0},computed:{uJustify(){return"end"==this.justify||"start"==this.justify?"flex-"+this.justify:"around"==this.justify||"between"==this.justify?"space-"+this.justify:this.justify},uAlignItem(){return"top"==this.align?"flex-start":"bottom"==this.align?"flex-end":this.align},colStyle(){const t={paddingLeft:uni.$u.addUnit(uni.$u.getPx(this.parentData.gutter)/2),paddingRight:uni.$u.addUnit(uni.$u.getPx(this.parentData.gutter)/2),alignItems:this.uAlignItem,justifyContent:this.uJustify,textAlign:this.textAlign,flex:`0 0 ${100/this.gridNum*this.span}%`,marginLeft:100/12*this.offset+"%"};return uni.$u.deepMerge(t,uni.$u.addStyle(this.customStyle))}},mounted(){this.init()},methods:{async init(){this.updateParentData(),this.width=await this.parent.getComponentWidth()},updateParentData(){this.getParentData("u-row")},clickHandler(t){this.$emit("click")}}},[["render",function(t,e,a,i,s,l){const d=p;return o(),n(d,{class:g(["u-col",["u-col-"+t.span]]),ref:"u-col",style:u([l.colStyle]),onClick:l.clickHandler},{default:r((()=>[h(t.$slots,"default",{},void 0,!0)])),_:3},8,["class","style","onClick"])}],["__scopeId","data-v-5afe83b6"]]),N=j({__name:"pushConfigDialog",props:{onlyPop:{type:Boolean,default:!1}},setup(t,{expose:e}){const a=t;let u=!1;const h=m(null),c=()=>{u=z.value,z.value=y.userInfo.push.WxPusher.active,j.value=y.userInfo.push.WxPusher.token,h.value.open()};e({handlePushConfig:c});const g=async()=>{z.value=u},$=f((()=>1!=y.userInfo.push.WxPusher.active?"未启用":"已启用")),S={WxPusher:{name:"WxPusher",token:"",active:""}},j=m(""),z=m(!1),D=t=>{z.value=t.detail.value},N=async()=>{S.WxPusher.token=j.value,S.WxPusher.active=z.value,y.userInfo.push.WxPusher.active=z.value,h.value.close(),await v.updateUserInfo({push:S})};return(t,e)=>{const u=i(s("uni-list-item"),I),m=i(s("uni-icons"),C),f=i(s("uni-easyinput"),P),y=i(s("u-row"),L),v=p,A=k,H=i(s("u-avatar"),U),M=i(s("u-col"),W),R=i(s("uni-popup-dialog"),E),q=i(s("uni-popup"),B);return o(),w(b,null,[a.onlyPop?d("",!0):(o(),n(u,{key:0,class:"item",onClick:c,title:"定制推送",rightText:x($),link:""},null,8,["rightText"])),l(q,{ref_key:"dialog",ref:h,type:"dialog"},{default:r((()=>[l(R,{type:"info",title:`${S.WxPusher.name} 配置`,onConfirm:N,onClose:g},{default:r((()=>[l(v,null,{default:r((()=>[l(y,{class:"flexItem mb10"},{default:r((()=>[l(m,{class:"popDialogIcon",type:"weixin",size:"22",color:"#c0c4cc"}),l(f,{class:"inputBox",inputBorder:!1,clearable:!1,trim:"both",modelValue:j.value,"onUpdate:modelValue":e[0]||(e[0]=t=>j.value=t),placeholder:"请输入 UID"},null,8,["modelValue"])])),_:1}),l(y,{class:"mb10"},{default:r((()=>[l(v,{class:"flexItem",style:{width:"100%","justify-content":"space-between","margin-bottom":"15px"}},{default:r((()=>[l(v,{class:"flexItem"},{default:r((()=>[l(m,{class:"popDialogIcon",type:"tune",size:"22",color:"#c0c4cc"}),l(v,{style:{"padding-left":"10px"}},{default:r((()=>[_("启用推送")])),_:1})])),_:1}),l(A,{checked:z.value,onChange:D,color:"#3893FE",style:{transform:"scale(0.7)","transform-origin":"right"}},null,8,["checked"])])),_:1})])),_:1}),l(y,{align:"top"},{default:r((()=>[l(M,{span:6},{default:r((()=>[l(H,{shape:"square",size:"120",src:"https://wxpusher.zjiecode.com/api/qrcode/L00o0fmFy66ZPAt8LQbuuOdXP2wvNt5ApRgGwl1qTsD5FudkdTCzM49vtEtC0tJj.jpg"})])),_:1}),l(M,{span:6},{default:r((()=>[l(v,{style:{"font-size":"12px",color:"#c0c4cc","margin-top":"8px"}},{default:r((()=>[_("1. 微信扫描二维码关注公众号，获取UID粘贴至上方输入框。")])),_:1}),l(v,{style:{"font-size":"12px",color:"#c0c4cc","margin-top":"6px"}},{default:r((()=>[_("2. 网络高峰时推送可能会有延迟或失败，以实际结果为准。")])),_:1})])),_:1})])),_:1}),l(y,null,{default:r((()=>[l(v,{style:{"font-size":"12px",color:"#c0c4cc","margin-top":"8px","padding-left":"8px"}},{default:r((()=>[_(" 此为第三方公众号定制推送，不同于图书馆公众号与噗噗Flag，其包含更详细的预约日志 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["title"])])),_:1},512)],64)}}},[["__scopeId","data-v-835c8645"]]);export{z as a,N as p,D as u};
